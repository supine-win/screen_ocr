# Windows打包模式说明

## 📦 两种打包模式对比

### **onefile模式 (单文件)**
```
📁 MonitorOCR_EasyOCR.exe    (~100MB)
```

**特点:**
- ✅ **便于分发**: 只有一个exe文件
- ✅ **网络友好**: 下载和传输方便
- ❌ **启动较慢**: 每次启动都要解压到临时目录
- ❌ **临时文件**: 在 `%TEMP%` 创建大量临时文件

**启动过程:**
```
1. 双击exe → 解压到 C:\Users\xxx\AppData\Local\Temp\_MEIxxxx\
2. 从临时目录启动程序 (15-30秒)
3. 程序关闭后临时文件可能残留
```

### **onedir模式 (目录分发)**
```
📁 MonitorOCR_EasyOCR/
├── MonitorOCR_EasyOCR.exe
├── torch/
├── easyocr/
├── paddle/
└── (其他依赖文件)       (~200-300MB)
```

**特点:**
- ✅ **启动快速**: 无需解压，直接运行 (2-5秒)
- ✅ **性能优秀**: 文件已解压，读取速度快
- ❌ **文件较多**: 需要保持目录结构完整  
- ❌ **体积较大**: 总体积比onefile大

**启动过程:**
```
1. 双击exe → 直接从当前目录启动 (2-5秒)
2. 无需解压，无临时文件
```

## 🎯 使用建议

### **选择onefile模式的场景:**
- 网络分发和下载
- 需要便携性的场合
- 偶尔使用的工具
- 存储空间敏感

### **选择onedir模式的场景:**
- 本地长期使用
- 需要快速启动
- 频繁使用的工具
- 性能敏感的应用

## 🚀 GitHub Actions构建

现在会同时构建两种版本：

```
release/
├── MonitorOCR_EasyOCR.exe           # onefile版本
├── MonitorOCR_EasyOCR/              # onedir版本
│   ├── MonitorOCR_EasyOCR.exe
│   └── (依赖文件)
├── config.json                      # 配置文件
└── README.md                        # 使用说明
```

## 💡 性能优化建议

### **onefile模式优化:**
1. **首次启动优化**: 程序已包含启动优化代码
2. **SSD存储**: 将exe放在SSD上加速解压
3. **杀毒白名单**: 避免实时扫描影响启动
4. **充足空间**: 确保临时目录有足够空间(500MB+)

### **onedir模式优化:**
1. **完整目录**: 保持所有文件在同一目录
2. **SSD存储**: 所有文件放在SSD上
3. **杀毒白名单**: 将整个目录加入白名单
4. **路径避免**: 避免路径包含中文和特殊字符

## 🔧 本地构建命令

```bash
# 构建onefile版本
python build_windows_modes.py --mode onefile

# 构建onedir版本  
python build_windows_modes.py --mode onedir

# 同时构建两种版本
python build_windows_modes.py --mode both
```

## 📊 性能对比表

| 特性 | onefile模式 | onedir模式 |
|------|------------|------------|
| 文件数量 | 1个 | 100+个 |
| 总体积 | ~100MB | ~200-300MB |
| 首次启动 | 15-30秒 | 2-5秒 |
| 后续启动 | 5-10秒 | 2-5秒 |
| 临时文件 | 大量 | 无 |
| 分发便利性 | ⭐⭐⭐⭐⭐ | ⭐⭐ |
| 运行性能 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

## 🎯 推荐方案

**大多数用户推荐**: onedir模式
- 启动速度提升5-10倍
- 更好的用户体验
- 无临时文件残留问题

**特殊场景选择**: onefile模式  
- 需要网络分发时
- 存储空间限制时
- 便携性要求高时
